"use strict";(globalThis.webpackChunkgoose=globalThis.webpackChunkgoose||[]).push([[3614],{5570:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>n,toc:()=>c});var n=t(29729),i=t(74848),a=t(28453);const s={title:"Code Mode MCP in goose",description:"An emerging approach to MCP tool calling gets an open source implementation in goose",authors:["alexhancock"]},r="Code Mode MCP",l={authorsImageUrls:[void 0]},c=[{value:"The approach",id:"the-approach",level:2},{value:"Summary",id:"summary",level:3},{value:"Benefits",id:"benefits",level:3},{value:"In goose",id:"in-goose",level:2},{value:"Help us evaluate it",id:"help-us-evaluate-it",level:2}];function d(e){const o={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components},{Head:n}=o;return n||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.p,{children:(0,i.jsx)(o.img,{alt:"code mode MCP in goose!",src:t(60493).A+"",width:"1600",height:"896"})}),"\n",(0,i.jsxs)(o.p,{children:['There is an emerging approach to MCP tool calling referred to as "sandbox mode" or "code mode". These ideas were initially\npresented by Cloudflare in their ',(0,i.jsx)(o.a,{href:"https://blog.cloudflare.com/code-mode/",children:"Code Mode: the better way to use MCP"})," post and Anthropic\nin their ",(0,i.jsx)(o.a,{href:"https://www.anthropic.com/engineering/code-execution-with-mcp",children:"Code execution with MCP: Building more efficient agents"}),"\nposts. Since the approach and the benefits are clearly laid out in those posts I will summarize them here."]}),"\n",(0,i.jsx)(o.h2,{id:"the-approach",children:"The approach"}),"\n",(0,i.jsx)(o.h3,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["Instead of exposing the tools directly to the model an MCP client application can:","\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Generate a programmatic interface to these same tools (typically JS or TS powered)"}),"\n",(0,i.jsx)(o.li,{children:"Provide a limited set of tools to the model (search available modules/tool source code, read the source code for a tool, and then a tool to execute some code)"}),"\n",(0,i.jsx)(o.li,{children:"Run the code the model generates to call the programmatic API in a sandboxed environment for safety"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(o.h3,{id:"benefits",children:"Benefits"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"The model can progressively discover relevant tools, without all server and tool definitions in the context window from the beginning"}),"\n",(0,i.jsx)(o.li,{children:"The model can chain tool call results into inputs to further tool calls without the intermediate results needing to flow back to the model - this saves on tokens and avoids exposing potentially sensitive data to the model unnecessarily"}),"\n",(0,i.jsx)(o.li,{children:"The models pre-training datasets have made them very efficient at analyzing large programmatic APIs and writing code to call them, as compared to having been trained only on contrived examples of MCP tool calling"}),"\n"]}),"\n",(0,i.jsx)(o.h2,{id:"in-goose",children:"In goose"}),"\n",(0,i.jsxs)(o.p,{children:["In v1.17.0 of goose, we've introduced an open source implementation of this idea in a new platform extension called: Code Execution.\nOur implementation generates a JavaScript interface representing the connected MCP tools and then lets the model write code to run\nagainst it in ",(0,i.jsx)(o.a,{href:"https://github.com/boa-dev/boa",children:"boa"})," which is an embeddable Javascript engine. One neat feature of boa we were able\nto take advantage of was the concept of ",(0,i.jsx)(o.a,{href:"https://docs.rs/boa_engine/latest/boa_engine/native_function/struct.NativeFunction.html",children:"NativeFunction"}),"."]}),"\n",(0,i.jsxs)(o.p,{children:["In boa, a ",(0,i.jsx)(o.code,{children:"NativeFunction"})," is something which exposes a function in the embedded JavaScript environment which calls back into a\nnatively implemented rust function. This is perfect for the calls originating in JS and then routing the tool call to the underlying\nMCP server with ease!"]}),"\n",(0,i.jsx)(o.h2,{id:"help-us-evaluate-it",children:"Help us evaluate it"}),"\n",(0,i.jsx)(o.p,{children:"Our hope is that we improve tool calling performance and handling of large numbers of tools in goose, but\nalso provide an open source implementation of this emerging approach."}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:['Try out the feature by enabling the "Code Execution" extension in v1.17.0 or later of goose by clicking extensions on the left side of the desktop app or running ',(0,i.jsx)(o.code,{children:"goose configure"})," on cli"]}),"\n",(0,i.jsxs)(o.li,{children:["Please give us feedback on how it works for you by joining our ",(0,i.jsx)(o.a,{href:"https://discord.gg/goose-oss",children:"discord"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["The source code is ",(0,i.jsx)(o.a,{href:"https://github.com/block/goose/blob/main/crates/goose/src/agents/code_execution_extension.rs",children:"here"})]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Kudos to my colleague ",(0,i.jsx)(o.a,{href:"https://github.com/michaelneale",children:"Mic Neale"})," for collaborating with me on the implementation!"]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("meta",{property:"og:title",content:"Code Mode MCP in goose"}),(0,i.jsx)("meta",{property:"og:type",content:"article"}),(0,i.jsx)("meta",{property:"og:url",content:"https://block.github.io/goose/blog/2025/12/15/code-mode-mcp-in-goose"}),(0,i.jsx)("meta",{property:"og:description",content:"An emerging approach to MCP tool calling gets an open source implementation in goose"}),(0,i.jsx)("meta",{property:"og:image",content:"https://block.github.io/goose/assets/images/header-image-1fa39f1d26aea7722e2c10fc424804f5.jpg"}),(0,i.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,i.jsx)("meta",{property:"twitter:domain",content:"block.github.io/goose"}),(0,i.jsx)("meta",{name:"twitter:title",content:"Code Mode MCP in goose"}),(0,i.jsx)("meta",{name:"twitter:description",content:"An emerging approach to MCP tool calling gets an open source implementation in goose"}),(0,i.jsx)("meta",{name:"twitter:image",content:"https://block.github.io/goose/assets/images/header-image-1fa39f1d26aea7722e2c10fc424804f5.jpg"})]})]})}function h(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,o,t)=>{t.d(o,{R:()=>s,x:()=>r});var n=t(96540);const i={},a=n.createContext(i);function s(e){const o=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(a.Provider,{value:o},e.children)}},29729:e=>{e.exports=JSON.parse('{"permalink":"/goose/blog/2025/12/15/code-mode-mcp","source":"@site/blog/2025-12-15-code-mode-mcp/index.md","title":"Code Mode MCP in goose","description":"An emerging approach to MCP tool calling gets an open source implementation in goose","date":"2025-12-15T00:00:00.000Z","tags":[],"readingTime":3.09,"hasTruncateMarker":true,"authors":[{"name":"Alex Hancock","title":"Software Engineer","page":{"permalink":"/goose/blog/authors/alexhancock"},"socials":{"linkedin":"https://www.linkedin.com/in/alexjhancock/","github":"https://github.com/alexhancock"},"imageURL":"https://avatars.githubusercontent.com/u/427516?v=4","key":"alexhancock"}],"frontMatter":{"title":"Code Mode MCP in goose","description":"An emerging approach to MCP tool calling gets an open source implementation in goose","authors":["alexhancock"]},"unlisted":false,"prevItem":{"title":"goose Mobile Access and Native Terminal Support","permalink":"/goose/blog/2025/12/19/goose-mobile-terminal"},"nextItem":{"title":"How to Stop Your AI Agent From Making Unwanted Code Changes","permalink":"/goose/blog/2025/12/10/stop-ai-agent-unwanted-changes"}}')},60493:(e,o,t)=>{t.d(o,{A:()=>n});const n=t.p+"assets/images/header-image-1fa39f1d26aea7722e2c10fc424804f5.jpg"}}]);