<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/sessions/smart-context-management" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Smart Context Management | goose</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://block.github.io/goose/img/home-banner.png"><meta data-rh="true" name="twitter:image" content="https://block.github.io/goose/img/home-banner.png"><meta data-rh="true" property="og:url" content="https://block.github.io/goose/docs/guides/sessions/smart-context-management"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Smart Context Management | goose"><meta data-rh="true" name="description" content="When working with Large Language Models (LLMs), there are limits to how much conversation history they can process at once. goose provides smart context management features to help handle context and conversation limits so you can maintain productive sessions. Here are some key concepts:"><meta data-rh="true" property="og:description" content="When working with Large Language Models (LLMs), there are limits to how much conversation history they can process at once. goose provides smart context management features to help handle context and conversation limits so you can maintain productive sessions. Here are some key concepts:"><link data-rh="true" rel="icon" href="/goose/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://block.github.io/goose/docs/guides/sessions/smart-context-management"><link data-rh="true" rel="alternate" href="https://block.github.io/goose/docs/guides/sessions/smart-context-management" hreflang="en"><link data-rh="true" rel="alternate" href="https://block.github.io/goose/docs/guides/sessions/smart-context-management" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Guides","item":"https://block.github.io/goose/docs/category/guides"},{"@type":"ListItem","position":2,"name":"Managing Sessions","item":"https://block.github.io/goose/docs/guides/sessions/"},{"@type":"ListItem","position":3,"name":"Smart Context Management","item":"https://block.github.io/goose/docs/guides/sessions/smart-context-management"}]}</script><link rel="alternate" type="application/rss+xml" href="/goose/blog/rss.xml" title="goose RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/goose/blog/atom.xml" title="goose Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZS5D6SB4ZJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZS5D6SB4ZJ",{anonymize_ip:!0})</script>









<link rel="alternate" type="text/plain" title="LLM context" href="/goose/llms.txt"><link rel="stylesheet" href="/goose/assets/css/styles.55a7d422.css">
<script src="/goose/assets/js/runtime~main.ce4b0899.js" defer="defer"></script>
<script src="/goose/assets/js/main.83a81719.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/goose/img/logo_light.png"><link rel="preload" as="image" href="/goose/img/logo_dark.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/goose/"><div class="navbar__logo"><img src="/goose/img/logo_light.png" alt="Block Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/goose/img/logo_dark.png" alt="Block Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/goose/docs/quickstart">Quickstart</a><a class="navbar__item navbar__link" href="/goose/docs/category/guides">Docs</a><a class="navbar__item navbar__link" href="/goose/docs/category/tutorials">Tutorials</a><a class="navbar__item navbar__link" href="/goose/docs/category/mcp-servers">MCPs</a><a class="navbar__item navbar__link" href="/goose/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/goose/extensions">Extensions</a></li><li><a class="dropdown__link" href="/goose/recipe-generator">Recipe Generator</a></li><li><a class="dropdown__link" href="/goose/prompt-library">Prompt Library</a></li><li><a class="dropdown__link" href="/goose/recipes">Recipe Cookbook</a></li><li><a class="dropdown__link" href="/goose/deeplink-generator">Deeplink Generator</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://discord.gg/goose-oss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/block/goose" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div id="inkeep"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/goose/docs/quickstart"><span title="Quickstart" class="linkLabel_WmDU">Quickstart</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/category/getting-started"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/goose/docs/category/guides"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/goose/docs/guides/sessions/"><span title="Managing Sessions" class="categoryLinkLabel_W154">Managing Sessions</span></a><button aria-label="Collapse sidebar category &#x27;Managing Sessions&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/sessions/session-management"><span title="Session Management" class="linkLabel_WmDU">Session Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/sessions/in-session-actions"><span title="In-Session Actions" class="linkLabel_WmDU">In-Session Actions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/goose/docs/guides/sessions/smart-context-management"><span title="Smart Context Management" class="linkLabel_WmDU">Smart Context Management</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/goose/docs/guides/context-engineering/"><span title="Context Engineering" class="categoryLinkLabel_W154">Context Engineering</span></a><button aria-label="Expand sidebar category &#x27;Context Engineering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/goose/docs/guides/recipes/"><span title="Recipes" class="categoryLinkLabel_W154">Recipes</span></a><button aria-label="Expand sidebar category &#x27;Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/managing-projects"><span title="Managing Projects" class="linkLabel_WmDU">Managing Projects</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/goose/docs/guides/managing-tools/"><span title="Managing Tools" class="categoryLinkLabel_W154">Managing Tools</span></a><button aria-label="Expand sidebar category &#x27;Managing Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/goose-permissions"><span title="goose Permissions" class="linkLabel_WmDU">goose Permissions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/updating-goose"><span title="Updating goose" class="linkLabel_WmDU">Updating goose</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/tips"><span title="Quick Tips" class="linkLabel_WmDU">Quick Tips</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/goose-cli-commands"><span title="CLI Commands" class="linkLabel_WmDU">CLI Commands</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/goose/docs/guides/security/"><span title="Security" class="categoryLinkLabel_W154">Security</span></a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/cli-providers"><span title="CLI Providers" class="linkLabel_WmDU">CLI Providers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/subagents"><span title="Subagents" class="linkLabel_WmDU">Subagents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/mcp-sampling"><span title="MCP Sampling" class="linkLabel_WmDU">MCP Sampling</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/goose/docs/guides/interactive-chat/"><span title="MCP Apps and MCP-UI" class="categoryLinkLabel_W154">MCP Apps and MCP-UI</span></a><button aria-label="Expand sidebar category &#x27;MCP Apps and MCP-UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/mcp-elicitation"><span title="MCP Elicitation" class="linkLabel_WmDU">MCP Elicitation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/handling-llm-rate-limits-with-goose"><span title="LLM Rate Limits" class="linkLabel_WmDU">LLM Rate Limits</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/logs"><span title="Logging System" class="linkLabel_WmDU">Logging System</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/file-management"><span title="File Management" class="linkLabel_WmDU">File Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/running-tasks"><span title="Run Tasks" class="linkLabel_WmDU">Run Tasks</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/using-gooseignore"><span title="Using gooseignore" class="linkLabel_WmDU">Using gooseignore</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/config-files"><span title="Configuration Files" class="linkLabel_WmDU">Configuration Files</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/creating-plans"><span title="Creating Plans" class="linkLabel_WmDU">Creating Plans</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/allowlist"><span title="Extension Allowlist" class="linkLabel_WmDU">Extension Allowlist</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/environment-variables"><span title="Environment Variables" class="linkLabel_WmDU">Environment Variables</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/multi-model/"><span title="Multi-Model Config" class="linkLabel_WmDU">Multi-Model Config</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/acp-clients"><span title="goose in ACP Clients" class="linkLabel_WmDU">goose in ACP Clients</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/enhanced-code-editing"><span title="Enhanced Code Editing" class="linkLabel_WmDU">Enhanced Code Editing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/codebase-analysis"><span title="Codebase Analysis" class="linkLabel_WmDU">Codebase Analysis</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goose/docs/guides/terminal-integration"><span title="Terminal Integration" class="linkLabel_WmDU">Terminal Integration</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/category/tutorials"><span title="Tutorials" class="categoryLinkLabel_W154">Tutorials</span></a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/category/mcp-servers"><span title="MCP Servers" class="categoryLinkLabel_W154">MCP Servers</span></a><button aria-label="Expand sidebar category &#x27;MCP Servers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/category/architecture-overview"><span title="Architecture Overview" class="categoryLinkLabel_W154">Architecture Overview</span></a><button aria-label="Expand sidebar category &#x27;Architecture Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/experimental/"><span title="Experimental" class="categoryLinkLabel_W154">Experimental</span></a><button aria-label="Expand sidebar category &#x27;Experimental&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/goose/docs/troubleshooting/"><span title="Troubleshooting" class="categoryLinkLabel_W154">Troubleshooting</span></a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col col--9"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/goose/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/goose/docs/category/guides"><span>Guides</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/goose/docs/guides/sessions/"><span>Managing Sessions</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Smart Context Management</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header class="flex justify-between items-start mb-4 flex-col md:flex-row gap-2 md:gap-0"><h1 class="m-0 flex-1">Smart Context Management</h1><div class="relative inline-flex"><div class="flex items-center bg-black dark:bg-white rounded-md"><div class="[&amp;&gt;button]:rounded-r-none"><button class="flex items-center gap-1.5 px-3 py-1.5 bg-black dark:bg-white text-white dark:text-black rounded-md text-sm font-medium transition-all duration-200 ease-in-out hover:opacity-90 hover:-translate-y-px focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-white focus:ring-offset-2 active:translate-y-px disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:opacity-60 disabled:hover:translate-y-0" aria-label="Copy page to clipboard" type="button" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy flex-shrink-0" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>Copy page</button></div><div class="w-px h-4 bg-gray-700 dark:bg-gray-300"></div><button class="px-2 py-1.5 bg-black dark:bg-white text-white dark:text-black rounded-l-none rounded-r-md text-sm font-medium transition-all duration-200 ease-in-out hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-white focus:ring-offset-2 flex items-center justify-center" aria-label="More page actions" aria-expanded="false" aria-haspopup="true"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></div></div></header><p>When working with <a class="" href="/goose/docs/getting-started/providers">Large Language Models (LLMs)</a>, there are limits to how much conversation history they can process at once. goose provides smart context management features to help handle context and conversation limits so you can maintain productive sessions. Here are some key concepts:</p>
<ul>
<li class=""><strong>Context Length</strong>: The amount of conversation history the LLM can consider, also referred to as the context window</li>
<li class=""><strong>Context Limit</strong>: The maximum number of tokens the model can process</li>
<li class=""><strong>Context Management</strong>: How goose handles conversations approaching these limits</li>
<li class=""><strong>Turn</strong>: One complete prompt-response interaction between goose and the LLM</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-goose-manages-context">How goose Manages Context<a href="#how-goose-manages-context" class="hash-link" aria-label="Direct link to How goose Manages Context" title="Direct link to How goose Manages Context" translate="no">​</a></h2>
<p>goose uses a two-tiered approach to context management:</p>
<ol>
<li class=""><strong>Auto-Compaction</strong>: Proactively summarizes conversation when approaching token limits</li>
<li class=""><strong>Context Strategies</strong>: Backup strategy used if the context limit is still exceeded after auto-compaction</li>
</ol>
<p>This layered approach lets goose handle token and context limits gracefully.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="automatic-compaction">Automatic Compaction<a href="#automatic-compaction" class="hash-link" aria-label="Direct link to Automatic Compaction" title="Direct link to Automatic Compaction" translate="no">​</a></h2>
<p>goose automatically compacts (summarizes) older parts of your conversation when approaching token limits, allowing you to maintain long-running sessions without manual intervention.
Auto-compaction is triggered by default when you reach 80% of the token limit in goose Desktop and the goose CLI.</p>
<p>Control the auto-compaction behavior with the <code>GOOSE_AUTO_COMPACT_THRESHOLD</code> <a class="" href="/goose/docs/guides/environment-variables#session-management">environment variable</a>.
Disable this feature by setting the value to <code>0.0</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Automatically compact sessions when 60% of available tokens are used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_AUTO_COMPACT_THRESHOLD=0.6</span><br></span></code></pre></div></div>
<p>When you reach the auto-compaction threshold:</p>
<ol>
<li class="">goose will automatically start compacting the conversation to make room.</li>
<li class="">Once complete, you&#x27;ll see a confirmation message that the conversation was compacted and summarized.</li>
<li class="">Continue the session. Your previous conversation remains visible, but only the compacted conversion is included in the active context for goose.</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="manual-compaction">Manual Compaction<a href="#manual-compaction" class="hash-link" aria-label="Direct link to Manual Compaction" title="Direct link to Manual Compaction" translate="no">​</a></h3>
<p>You can also trigger compaction manually before reaching context or token limits:</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol>
<li class="">Point to the token usage indicator dot next to the model name at the bottom of the app</li>
<li class="">Click <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scroll-text inline"><path d="M15 12h-5"></path><path d="M15 8h-5"></path><path d="M19 17V5a2 2 0 0 0-2-2H4"></path><path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"></path></svg> <code>Compact now</code> in the context window that appears</li>
<li class="">Once complete, you&#x27;ll see a confirmation message that the conversation was compacted and summarized.</li>
<li class="">Continue the session. Your previous conversation remains visible, but only the compacted conversion is included in the active context for goose.</li>
</ol><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>You must send at least one message in the chat before the <code>Compact now</code> button is enabled.</p></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>To proactively trigger summarization before reaching context limits, use the <code>/summarize</code> command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">( O)&gt; /summarize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◇  Are you sure you want to summarize this conversation? This will condense the message history.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Yes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Summarizing conversation...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Conversation has been summarized.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key information has been preserved while reducing context length.</span><br></span></code></pre></div></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="context-limit-strategies">Context Limit Strategies<a href="#context-limit-strategies" class="hash-link" aria-label="Direct link to Context Limit Strategies" title="Direct link to Context Limit Strategies" translate="no">​</a></h2>
<p>When auto-compaction is disabled, or if a conversation still exceeds the context limit, goose offers different ways to handle it:</p>
<table><thead><tr><th>Feature</th><th>Description</th><th>Best For</th><th>Availability</th><th>Impact</th></tr></thead><tbody><tr><td><strong>Summarization</strong></td><td>Condenses conversation while preserving key points</td><td>Long, complex conversations</td><td>Desktop and CLI</td><td>Maintains most context</td></tr><tr><td><strong>Truncation</strong></td><td>Removes oldest messages to make room</td><td>Simple, linear conversations</td><td>CLI only</td><td>Loses old context</td></tr><tr><td><strong>Clear</strong></td><td>Starts fresh while keeping session active</td><td>New direction in conversation</td><td>CLI only</td><td>Loses all context</td></tr><tr><td><strong>Prompt</strong></td><td>Asks user to choose from the above options</td><td>Control over each decision in interactive sessions</td><td>CLI only</td><td>Depends on choice made</td></tr></tbody></table>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>goose Desktop exclusively uses summarization by compacting the conversation to manage context, preserving key information while reducing size.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>The CLI supports all context limit strategies: <code>summarize</code>, <code>truncate</code>, <code>clear</code>, and <code>prompt</code>.</p><p>The default behavior depends on the mode you&#x27;re running in:</p><ul>
<li class=""><strong>Interactive mode</strong>: Prompts user to choose (equivalent to <code>prompt</code>)</li>
<li class=""><strong>Headless mode</strong> (<code>goose run</code>): Automatically summarizes (equivalent to <code>summarize</code>)</li>
</ul><p>You can configure how goose handles context limits by setting the <code>GOOSE_CONTEXT_STRATEGY</code> environment variable:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set automatic strategy (choose one)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_STRATEGY=summarize  # Automatically summarize (recommended)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_STRATEGY=truncate   # Automatically remove oldest messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_STRATEGY=clear      # Automatically clear session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set to prompt the user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_STRATEGY=prompt</span><br></span></code></pre></div></div><p>When you hit the context limit, the behavior depends on your configuration:</p><p><strong>With default settings (no <code>GOOSE_CONTEXT_STRATEGY</code> set)</strong>, you&#x27;ll see this prompt to choose a management option:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">◇  The model&#x27;s context length is maxed out. You will need to reduce the # msgs. Do you want to?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Clear Session   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Truncate Message</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">│  ● Summarize Session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final_summary: [A summary of your conversation will appear here]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context maxed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goose summarized messages for you.</span><br></span></code></pre></div></div><p><strong>With <code>GOOSE_CONTEXT_STRATEGY</code> configured</strong>, goose will automatically apply your chosen strategy:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Example with GOOSE_CONTEXT_STRATEGY=summarize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context maxed out - automatically summarized messages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goose automatically summarized messages for you.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example with GOOSE_CONTEXT_STRATEGY=truncate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context maxed out - automatically truncated messages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goose tried its best to truncate messages for you.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example with GOOSE_CONTEXT_STRATEGY=clear</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context maxed out - automatically cleared session.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------</span><br></span></code></pre></div></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="maximum-turns">Maximum Turns<a href="#maximum-turns" class="hash-link" aria-label="Direct link to Maximum Turns" title="Direct link to Maximum Turns" translate="no">​</a></h2>
<p>The <code>Max Turns</code> limit is the maximum number of consecutive turns that goose can take without user input (default: 1000). When the limit is reached, goose stops and prompts: &quot;I&#x27;ve reached the maximum number of actions I can do without user input. Would you like me to continue?&quot; If the user answers in the affirmative, goose continues until the limit is reached and then prompts again.</p>
<p>This feature gives you control over agent autonomy and prevents infinite loops and runaway behavior, which could have significant cost consequences or damaging impact in production environments. Use it for:</p>
<ul>
<li class="">Preventing infinite loops and excessive API calls or resource consumption in automated tasks</li>
<li class="">Enabling human supervision or interaction during autonomous operations</li>
<li class="">Controlling loops while testing and debugging agent behavior</li>
</ul>
<p>This setting is stored as the <code>GOOSE_MAX_TURNS</code> environment variable in your <a class="" href="/goose/docs/guides/config-files">config.yaml file</a>. You can configure it using the Desktop app or CLI.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol>
<li class="">Click the <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left inline"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg> button in the top-left to open the sidebar</li>
<li class="">Click the <code>Settings</code> button on the sidebar</li>
<li class="">Click the <code>Chat</code> tab</li>
<li class="">Scroll to <code>Conversation Limits</code> and enter a value for <code>Max Turns</code></li>
</ol></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><ol>
<li class="">Run the <code>configuration</code> command:</li>
</ol><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">goose configure</span><br></span></code></pre></div></div><ol start="2">
<li class="">Select <code>goose settings</code>:</li>
</ol><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌   goose-configure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◆  What would you like to configure?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Configure Providers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Add Extension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Toggle Extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Remove Extension</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">│  ● goose settings (Set the goose mode, Tool Output, Tool Permissions, Experiment, goose recipe github repo and more)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└ </span><br></span></code></pre></div></div><ol start="3">
<li class="">Select <code>Max Turns</code>:</li>
</ol><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌   goose-configure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◇  What would you like to configure?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  goose settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◆  What setting would you like to configure?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ goose mode </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Router Tool Selection Strategy </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Tool Permission </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Tool Output </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">│  ● Max Turns (Set maximum number of turns without user input)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Toggle Experiment </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ goose recipe github repo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ○ Scheduler Type </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└ </span><br></span></code></pre></div></div><ol start="4">
<li class="">Enter the maximum number of turns:</li>
</ol><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌   goose-configure </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◇  What would you like to configure?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  goose settings </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">◇  What setting would you like to configure?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Max Turns </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">◆  Set maximum number of agent turns without user input:</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">│  10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└  Set maximum turns to 10 - goose will ask for input after 10 consecutive actions</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In addition to the persistent <code>Max Turns</code> setting, you can provide a runtime override for a specific session or task via the <code>goose session --max-turns</code> and <code>goose run --max-turns</code> <a class="" href="/goose/docs/guides/goose-cli-commands">CLI commands</a>.</p></div></div></div></div></div>
<p><strong>Choosing the Right Value</strong></p>
<p>The appropriate max turns value depends on your use case and comfort level with automation:</p>
<ul>
<li class=""><strong>5-10 turns</strong>: Good for exploratory tasks, debugging, or when you want frequent check-ins. For example, &quot;analyze this codebase and suggest improvements&quot; where you want to review each step</li>
<li class=""><strong>25-50 turns</strong>: Effective for well-defined tasks with moderate complexity, such as &quot;refactor this module to use the new API&quot; or &quot;set up a basic CI/CD pipeline&quot;</li>
<li class=""><strong>100+ turns</strong>: More suitable for complex, multi-step automation where you trust goose to work independently, like &quot;migrate this entire project from React 16 to React 18&quot; or &quot;implement comprehensive test coverage for this service&quot;</li>
</ul>
<p>Remember that even simple-seeming tasks often require multiple turns. For example, asking goose to &quot;fix the failing tests&quot; might involve analyzing test output (1 turn), identifying the root cause (1 turn), making code changes (1 turn), and verifying the fix (1 turn).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="token-usage">Token Usage<a href="#token-usage" class="hash-link" aria-label="Direct link to Token Usage" title="Direct link to Token Usage" translate="no">​</a></h2>
<p>After sending your first message, goose Desktop and goose CLI display token usage.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>The Desktop displays a colored circle next to the model name at the bottom of the session window. The color provides a visual indicator of your token usage for the session.</p><ul>
<li class=""><strong>Green</strong>: Normal usage - Plenty of context space available</li>
<li class=""><strong>Orange</strong>: Warning state - Approaching limit (80% of capacity)</li>
<li class=""><strong>Red</strong>: Error state - Context limit reached</li>
</ul><p>Hover over this circle to display:</p><ul>
<li class="">The number of tokens used</li>
<li class="">The percentage of available tokens used</li>
<li class="">The total available tokens</li>
<li class="">A progress bar showing your current token usage</li>
</ul></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>The CLI displays a context label above each command prompt, showing:</p><ul>
<li class="">A visual indicator using dots (●○) and colors to represent your token usage:<!-- -->
<ul>
<li class=""><strong>Green</strong>: Below 50% usage</li>
<li class=""><strong>Yellow</strong>: Between 50-85% usage</li>
<li class=""><strong>Red</strong>: Above 85% usage</li>
</ul>
</li>
<li class="">Usage percentage</li>
<li class="">Current token count and context limit</li>
</ul></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-context-limit-overrides">Model Context Limit Overrides<a href="#model-context-limit-overrides" class="hash-link" aria-label="Direct link to Model Context Limit Overrides" title="Direct link to Model Context Limit Overrides" translate="no">​</a></h2>
<p>Context limits are automatically detected based on your model name, but goose provides settings to override the default limits:</p>
<table><thead><tr><th>Model</th><th>Description</th><th>Best For</th><th>Setting</th></tr></thead><tbody><tr><td><strong>Main</strong></td><td>Set context limit for the main model (also serves as fallback for other models)</td><td>LiteLLM proxies, custom models with non-standard names</td><td><code>GOOSE_CONTEXT_LIMIT</code></td></tr><tr><td><strong>Lead</strong></td><td>Set larger context for planning in <a class="" href="/goose/docs/tutorials/lead-worker">lead/worker mode</a></td><td>Complex planning tasks requiring more context</td><td><code>GOOSE_LEAD_CONTEXT_LIMIT</code></td></tr><tr><td><strong>Worker</strong></td><td>Set smaller context for execution in lead/worker mode</td><td>Cost optimization during execution phase</td><td><code>GOOSE_WORKER_CONTEXT_LIMIT</code></td></tr><tr><td><strong>Planner</strong></td><td>Set context for <a class="" href="/goose/docs/guides/creating-plans">planner models</a></td><td>Large planning tasks requiring extensive context</td><td><code>GOOSE_PLANNER_CONTEXT_LIMIT</code></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>This setting only affects the displayed token usage and progress indicators. Actual context management is handled by your LLM, so you may experience more or less usage than the limit you set, regardless of what the display shows.</p></div></div>
<p>This feature is particularly useful with:</p>
<ul>
<li class=""><strong>LiteLLM Proxy Models</strong>: When using LiteLLM with custom model names that don&#x27;t match goose&#x27;s patterns</li>
<li class=""><strong>Enterprise Deployments</strong>: Custom model deployments with non-standard naming</li>
<li class=""><strong>Fine-tuned Models</strong>: Custom models with different context limits than their base versions</li>
<li class=""><strong>Development/Testing</strong>: Temporarily adjusting context limits for testing purposes</li>
</ul>
<p>goose resolves context limits with the following precedence (highest to lowest):</p>
<ol>
<li class="">Explicit context_limit in model configuration (if set programmatically)</li>
<li class="">Specific environment variable (e.g., <code>GOOSE_LEAD_CONTEXT_LIMIT</code>)</li>
<li class="">Global environment variable (<code>GOOSE_CONTEXT_LIMIT</code>)</li>
<li class="">Model-specific default based on name pattern matching</li>
<li class="">Global default (128,000 tokens)</li>
</ol>
<p><strong>Configuration</strong></p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Model context limit overrides are not yet available in the goose Desktop app.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Context limit overrides only work as <a class="" href="/goose/docs/guides/environment-variables#model-context-limit-overrides">environment variables</a>, not in the config file.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_LIMIT=1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goose session</span><br></span></code></pre></div></div></div></div></div>
<p><strong>Scenarios</strong></p>
<ol>
<li class="">LiteLLM proxy with custom model name</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># LiteLLM proxy with custom model name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_PROVIDER=&quot;openai&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_MODEL=&quot;my-custom-gpt4-proxy&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CONTEXT_LIMIT=200000  # Override the 32k default</span><br></span></code></pre></div></div>
<ol start="2">
<li class="">Lead/worker setup with different context limits</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Different context limits for planning vs execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_LEAD_MODEL=&quot;claude-opus-custom&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_LEAD_CONTEXT_LIMIT=500000    # Large context for planning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_WORKER_CONTEXT_LIMIT=128000  # Smaller context for execution</span><br></span></code></pre></div></div>
<ol start="3">
<li class="">Planner with large context</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Large context for complex planning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_PLANNER_MODEL=&quot;gpt-4-custom&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_PLANNER_CONTEXT_LIMIT=1000000</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cost-tracking">Cost Tracking<a href="#cost-tracking" class="hash-link" aria-label="Direct link to Cost Tracking" title="Direct link to Cost Tracking" translate="no">​</a></h2>
<p>Display real-time estimated costs of your session.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">goose Desktop</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">goose CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>To manage live cost tracking:</p><ol>
<li class="">Click the <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left inline"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg> button in the top-left to open the sidebar</li>
<li class="">Click the <code>Settings</code> button on the sidebar</li>
<li class="">Click the <code>App</code> tab</li>
<li class="">Toggle <code>Cost Tracking</code> on/off</li>
</ol><p>The session cost is shown at the bottom of the goose window and updates dynamically as tokens are consumed. Hover over the cost to see a detailed breakdown of token usage. If multiple models are used in the session, this includes a cost breakdown by model. Ollama and local deployments always show a cost of $0.00.</p><p>Pricing data is regularly fetched from the OpenRouter API and cached locally. The <code>Advanced settings</code> tab shows when the data was last updated and allows you to refresh.</p><p>These costs are estimates only, and not connected to your actual provider bill. The cost shown is an approximation based on token counts and public pricing data.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Show estimated cost in the goose CLI by setting the <code>GOOSE_CLI_SHOW_COST</code> <a class="" href="/goose/docs/guides/environment-variables#session-management">environment variable</a> or including it in the <a class="" href="/goose/docs/guides/config-files">configuration file</a>.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set environment variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOSE_CLI_SHOW_COST=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOSE_CLI_SHOW_COST: true</span><br></span></code></pre></div></div></div></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/goose/docs/guides/sessions/in-session-actions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">In-Session Actions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/goose/docs/guides/context-engineering/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Context Engineering</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-goose-manages-context" class="table-of-contents__link toc-highlight">How goose Manages Context</a></li><li><a href="#automatic-compaction" class="table-of-contents__link toc-highlight">Automatic Compaction</a><ul><li><a href="#manual-compaction" class="table-of-contents__link toc-highlight">Manual Compaction</a></li></ul></li><li><a href="#context-limit-strategies" class="table-of-contents__link toc-highlight">Context Limit Strategies</a></li><li><a href="#maximum-turns" class="table-of-contents__link toc-highlight">Maximum Turns</a></li><li><a href="#token-usage" class="table-of-contents__link toc-highlight">Token Usage</a></li><li><a href="#model-context-limit-overrides" class="table-of-contents__link toc-highlight">Model Context Limit Overrides</a></li><li><a href="#cost-tracking" class="table-of-contents__link toc-highlight">Cost Tracking</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Quick Links</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/goose/docs/getting-started/installation">Install goose</a></li><li class="footer__item"><a class="footer__link-item" href="/goose/extensions">Extensions</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/goose/community">Spotlight</a></li><li class="footer__item"><a href="https://discord.gg/goose-oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@goose-oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/goose-oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/goose_oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter / X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://bsky.app/profile/opensource.block.xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">BlueSky<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://njump.me/opensource@block.xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Nostr<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/goose/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/block/goose" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Block, Inc.</div></div></div></footer></div>
<script src="/goose/inkeepChatButton.js" type="module"></script>
<div id="inkeepSearchBar"></div>
<script>(()=>{const e=document.getElementById("inkeepSearchBar");new MutationObserver(t=>{const n=document.getElementById("inkeep");n&&n.appendChild(e)}).observe(document.documentElement,{attributes:!0})})()</script>
<script src="/goose/inkeepSearchBar.js" type="module"></script></body>
</html>